---
layout: post
title: Do-Tell
thumbnail-path: "/img/do-tell-bitwolf.png"
short-description: An analytics tracker for web apps
feature-img: "img/rainbow.jpg"

---
###Summary

Do-Tell is an analytics tracker built in Rails. Users can register their web application and monitor the frequency and distribution of any events they specify.

As a student, I wanted to learn the fundamentals of back-end web development and create a project that could communicate with other applications.

###Development

I used Devise for authentication of users, and then allowed them to register their applications through a custom controller by specifying a name and unique URL.

{% highlight ruby %}
def create
  @application = current_user.applications.build(application_params)

  if @application.save
    flash[:notice] = "Your new application has been registered."
    redirect_to applications_path
  else
    flash[:error] = "There was an error registering your application. Please try again."
    render :new
  end
end

...

validates_uniqueness_of :url, message: "already belongs to another application"
{% endhighlight %}

Once an application is registered, users connect it to Do-Tell by adding a JavaScript snippet to their site's code.

From the README:
![README](/img/do-tell_readme.png)

I used Chartkick and Groupdate, along with Google Charts to generate graphical representations of the <strong>events</strong> reported by the registered applications.

![Pie Chart](/img/pie_chart.png)
![Line Graph](/img/line_graph.png)

I also wrote a custom method to generate a table of events and the number of times they occurred that matches the colors generated by the pie chart.

{% highlight ruby %}
# The colors used by Google Charts
# The last color is placed at index 0
# to allow for "modulo wrapping"
COLORS = ['#743411', '#3366CC', '#DC3912', '#FF9900',
          '#109618', '#990099', '#0099C6', '#DD4477',
          '#66AA00', '#B82E2E', '#316395', '#994499',
          '#22AA99', '#AAAA11', '#6633CC', '#E67300',
          '#8B0707', '#651067', '#329262', '#5574a6',
          '#3b3eac', '#b77322', '#16d620', '#b91383',
          '#f4359e', '#9c5935', '#a9c413', '#2a778d',
          '#668d1c', '#bea413', '#0c5922']

HIGHEST_COLOR_VALUE = COLORS.length

def select_color(index=rand(1..COLORS.length))
  COLORS[index % HIGHEST_COLOR_VALUE]
end
{% endhighlight %}

{% highlight html %}
<table id="event-list">
  <tr>
    <th>Event</th>
    <th>Count</th>
  </tr>
  <% event_counts.each_with_index do |(event_name, count), i| %>
    <tr style="background-color:<%= select_color(i + 1) %>" >
      <td><%= event_name %></td>
      <td><%= count %></td>
    </tr>
  <% end %>
</table>
{% endhighlight %}

![Table](/img/table.png)



###Testing

As with my other applications, I built Do-Tell with Test Driven Development using a combination of low-level unit testing (with RSpec, Factory Girl, and Shoulda)

{% highlight ruby %}
it "does not assign @application" do
  get :show, id: other_user_owned_application.id
  expect(assigns(:application)).to be_nil
end
{% endhighlight %}

and higher-level simulated user experiences (with Capybara and Selenium Webdriver).

{% highlight ruby %}
login_user(user)

expect(page).to have_title("Registered Applications")

click_link "New Application"

expect(page).to have_title("New Application")

fill_in "Name", with: "MyNewApp"
fill_in "Url", with: "https://mynewapp.example.com"
click_button "Save"
{% endhighlight %}

###Conclusion

I think I achieved everything I set out to do with Do-Tell. I was even able to connect it to [Within-A-Week](within-a-week.html), my to-do list application, to track user registrations and the creation and completion of goals.
